Master Prompt
You are ChatGPT/Codex working on the Spectra App, a desktop Spectroscopy Toolkit (STEC) project. The goal is to polish the application and implement new features (while passing all existing tests) according to our design and data analysis goals[1][2]. Use a docs-first development process and follow the project’s guidelines[2]. In particular, preserve the UI contract (do not remove or break required controls) and update the version, patch notes, and AI log whenever you add or change behavior[2].
•	Implement data storage and sources: Allow user-uploaded spectral files to be stored locally in the app (persist across sessions). Also integrate remote queries to authoritative data sources: e.g., use the NASA/MAST API to fetch JWST and other telescope spectra (via scripted queries)[3], and use NIST atomic spectra data for reference line lists[4]. For IR spectra, build or improve the NIST IR fetcher (normalize metadata, cache results, choose preferred window) as in the Quant IR fetcher.[5][4] Ensure data provenance is recorded (source names, dates, units, etc.) in overlays.
•	Follow existing design and tests: Before coding, consult the local documentation index (RAG) and respect the UI contract[2]. All new changes must keep tests passing; update or add pytest tests for any new fetchers or UI elements. For example, add tests for new NIST/JWST fetch logic or offline storage behaviors. Preserve idempotency rules, legend hygiene, toggle semantics, and ledger behavior per the safety rules[6].
•	Enhance the UI: Make the interface clean and user-friendly. Group controls logically and avoid overwhelming the user. Display essential information (spectrum metadata, units, source credits) alongside plots. Credit all data sources in the UI (e.g. show dataset citation, authors, and acquisition details for each spectrum)[1]. If adding new sidebar panels or examples, follow the style from recent UI updates (see how examples were moved to the sidebar in v1.2.0h[7]). Use compact expanders or tooltips to hide advanced info as needed.
•	Integrate spectroscopic knowledge: Incorporate domain-specific processing: e.g. use Specutils/Astropy containers for handling spectra (Spectrum, SpectrumList)[8], implement unit conversions that ripple across all plots (without mutating raw data)[9], and allow fitting or smoothing plugins (gaussian smoothing, model fitting) as analysis tools[9]. Use atomic line catalogs (from NIST or custom lists) with an interactive redshift slider or offset control. When implementing these, ensure they match SpecViz-inspired behavior (see [SpecViz adaptation blueprint] for guidance)[9].
•	Maintain documentation and logging: For every change, update documentation: bump app/version.json, write patch notes (docs/patch_notes/v*.md), and append to docs/ai_log/. Document your rationale in atlas/brains.md. Add or revise user documentation: for example, write an import/data guide, a display/controls guide, and an export guide, mirroring SpecViz’s structure[10]. Make sure the UI contract JSON and tests are updated if any UI changes are needed[2].
•	Don’t break things: Run pytest to catch regressions (as recommended by the AI logs[11]). Ensure version increments and patch logs are recorded. Follow the commit checklist (agents.md) to avoid missing documentation or tests[6].
Suggested Documentation Additions
•	User Guide: Create clear user manuals covering how to load different types of spectra, switch units, and interpret plots. Include a tutorial for common tasks (overlaying a telescope spectrum with a lab spectrum, fitting a peak, etc.). Document where to find online data (e.g. JWST archives, MAST API usage[3], NIST databases[4]) and how it’s integrated. Explain all UI controls (e.g. what each plot legend icon does, how to lock traces, etc.) in accordance with our UI contract[2].
•	Domain References: Add sections (or linked appendices) explaining relevant science background: basics of spectroscopy (wavelength vs. wavenumber, flux vs. absorbance), atomic emission spectra (quantum transitions, NIST ASD explanations[4]), and how exoplanet/stellar spectra are obtained (JWST, ground telescopes). Include explanations of analysis techniques (Gaussian smoothing, continuum subtraction, line fitting) with references. This scientific context will help users understand results and will provide context for the AI (via RAG) to draw on.
•	Developer Documentation: In docs/atlas/ or docs/ folder, maintain technical notes (like the SpecViz adaptation plan[9]) and code guides. For example, explain the data ingestion pipeline (local vs. remote, cache strategy), the export manifest schema, and plugin architecture. Document any custom API helpers (e.g. nist_quant_ir fetcher). Also include coding conventions (from AGENTS.md[2]) so future contributors and the AI know the rules.
•	Citation Guide: Create a short doc on citing data and the app itself (e.g. use DOIs or NASA ADS references for major datasets, similar to SpecViz’s Zenodo style[10]). Emphasize giving credit to data providers and algorithms in exports or UI footers.
These instructions and documentation additions should align the AI’s work with our scientific goals, ensure stability via tests, and educate both users and the AI agent about spectroscopic data and analysis[1][10].
________________________________________
[1] README.md
https://github.com/brettadin/spectra-app/blob/2b2384df660915df00e6fd6ee5dedaabab6c7194/README.md
[2] [6] agents.md
https://github.com/brettadin/spectra-app/blob/2b2384df660915df00e6fd6ee5dedaabab6c7194/agents.md
[3] MAST API Access - JWST User Documentation
https://jwst-docs.stsci.edu/accessing-jwst-data/mast-api-access
[4] Atomic Spectra Database | NIST
https://www.nist.gov/pml/atomic-spectra-database
[5] brains.md
https://github.com/brettadin/spectra-app/blob/2b2384df660915df00e6fd6ee5dedaabab6c7194/docs/atlas/brains.md
[7] [11] 2025-10-04.md
https://github.com/brettadin/spectra-app/blob/2b2384df660915df00e6fd6ee5dedaabab6c7194/docs/ai_log/2025-10-04.md
[8] [9] [10] specviz_adaptation_outline.md
https://github.com/brettadin/spectra-app/blob/2b2384df660915df00e6fd6ee5dedaabab6c7194/docs/research/specviz_adaptation_outline.md
